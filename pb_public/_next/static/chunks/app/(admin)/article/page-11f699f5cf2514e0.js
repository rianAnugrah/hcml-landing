(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[826],{1325:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(6814),l=s(2094);let r=new(s(5956)).Ay("http://127.0.0.1:8090"),n={title:"",slug:"",excerpt:"",content:"",author:"",category:"",tags:[],status:"draft",featured:!1,allow_comments:!0,views:0,reading_time:0,published_at:"",meta_title:"",meta_description:"",meta_keywords:""};function i(){let[e,t]=(0,l.useState)([]),[s,i]=(0,l.useState)(!0),[o,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(n),[m,x]=(0,l.useState)(null),[g,b]=(0,l.useState)(""),[h,f]=(0,l.useState)(!1),[y,p]=(0,l.useState)([]),[j,w]=(0,l.useState)([]),[N,v]=(0,l.useState)([]),_=async()=>{i(!0);try{let e=await r.collection("news_articles").getFullList({sort:"-created"});t(e)}catch(e){b("Failed to fetch articles")}i(!1)},k=async()=>{try{let e=await r.collection("users").getFullList({sort:"name,email"});p(e)}catch(e){}},C=async()=>{try{let e=await r.collection("news_categories").getFullList({sort:"sort_order,name"});w(e)}catch(e){}},S=async()=>{try{let e=await r.collection("news_tags").getFullList({sort:"name"});v(e)}catch(e){}};(0,l.useEffect)(()=>{_(),k(),C(),S()},[]);let A=e=>{let{name:t,value:s,type:a}=e.target;"checkbox"===a?u(s=>({...s,[t]:e.target.checked})):"tags"===t?u(e=>({...e,tags:s.split(",").map(e=>e.trim()).filter(Boolean)})):u(e=>({...e,[t]:s}))},F=e=>{u({...e,tags:Array.isArray(e.tags)?e.tags:[]}),x(e.id||null),c(!0),b("")},D=()=>{c(!1),x(null),u(n),b("")},E=async e=>{e.preventDefault(),f(!0),b("");try{let e={...d,views:Number(d.views),reading_time:Number(d.reading_time),featured:!!d.featured,allow_comments:!!d.allow_comments,tags:Array.isArray(d.tags)?d.tags:[]};m?await r.collection("news_articles").update(m,e):await r.collection("news_articles").create(e),await _(),D()}catch(e){b((null==e?void 0:e.message)||"Failed to save article")}f(!1)},L=async e=>{if(window.confirm("Delete this article?"))try{await r.collection("news_articles").delete(e),t(t=>t.filter(t=>t.id!==e))}catch(e){alert("Failed to delete article")}},T=e=>{let t=y.find(t=>t.id===e);return t?t.name||t.email||t.id:e},q=e=>{let t=j.find(t=>t.id===e);return t?t.name:e},M=e=>e.map(e=>{let t=N.find(t=>t.id===e);return t?t.name:e}).join(", ");return(0,a.jsxs)("div",{className:"p-8 max-w-6xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Articles Admin"}),(0,a.jsx)("button",{className:"bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2",onClick:()=>{u(n),x(null),c(!0),b("")},children:"+ New Article"})]}),s?(0,a.jsx)("div",{className:"text-center py-12 text-gray-600",children:"Loading..."}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full bg-white border border-gray-300 rounded shadow",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-800 text-white",children:[(0,a.jsx)("th",{className:"p-2 border-b border-gray-300 font-semibold",children:"Title"}),(0,a.jsx)("th",{className:"p-2 border-b border-gray-300 font-semibold",children:"Slug"}),(0,a.jsx)("th",{className:"p-2 border-b border-gray-300 font-semibold",children:"Status"}),(0,a.jsx)("th",{className:"p-2 border-b border-gray-300 font-semibold",children:"Author"}),(0,a.jsx)("th",{className:"p-2 border-b border-gray-300 font-semibold",children:"Category"}),(0,a.jsx)("th",{className:"p-2 border-b border-gray-300 font-semibold",children:"Tags"}),(0,a.jsx)("th",{className:"p-2 border-b border-gray-300 font-semibold",children:"Views"}),(0,a.jsx)("th",{className:"p-2 border-b border-gray-300 font-semibold",children:"Published"}),(0,a.jsx)("th",{className:"p-2 border-b border-gray-300 font-semibold",children:"Actions"})]})}),(0,a.jsxs)("tbody",{children:[e.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-100",children:[(0,a.jsx)("td",{className:"p-2 text-gray-900",children:e.title}),(0,a.jsx)("td",{className:"p-2 text-gray-900",children:e.slug}),(0,a.jsx)("td",{className:"p-2 text-gray-900",children:e.status}),(0,a.jsx)("td",{className:"p-2 text-gray-900",children:T(e.author)}),(0,a.jsx)("td",{className:"p-2 text-gray-900",children:q(e.category)}),(0,a.jsx)("td",{className:"p-2 text-gray-900",children:Array.isArray(e.tags)?M(e.tags):""}),(0,a.jsx)("td",{className:"p-2 text-gray-900",children:e.views}),(0,a.jsx)("td",{className:"p-2 text-gray-900",children:e.published_at?new Date(e.published_at).toLocaleDateString():""}),(0,a.jsxs)("td",{className:"p-2 space-x-2",children:[(0,a.jsx)("button",{className:"text-blue-800 font-semibold hover:underline focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>F(e),children:"Edit"}),(0,a.jsx)("button",{className:"text-red-700 font-semibold hover:underline focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>L(e.id),children:"Delete"})]})]},e.id)),0===e.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:9,className:"text-center text-gray-500 py-8",children:"No articles found."})})]})]})}),o&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70",children:(0,a.jsxs)("div",{className:"bg-white rounded shadow-lg w-full max-w-2xl p-8 relative border-2 border-gray-800",children:[(0,a.jsx)("button",{className:"absolute top-3 right-3 text-gray-700 hover:text-black text-2xl font-bold focus:outline-none",onClick:D,"aria-label":"Close",children:"\xd7"}),(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900",children:m?"Edit Article":"New Article"}),g&&(0,a.jsx)("div",{className:"mb-4 text-red-700 font-semibold",children:g}),(0,a.jsxs)("form",{onSubmit:E,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Title"}),(0,a.jsx)("input",{name:"title",value:d.title,onChange:A,required:!0,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Slug"}),(0,a.jsx)("input",{name:"slug",value:d.slug,onChange:A,required:!0,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Excerpt"}),(0,a.jsx)("input",{name:"excerpt",value:d.excerpt,onChange:A,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Content"}),(0,a.jsx)("textarea",{name:"content",value:d.content,onChange:A,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400",rows:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Author"}),(0,a.jsxs)("select",{name:"author",value:d.author,onChange:A,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select author..."}),y.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name||e.email||e.id},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Category"}),(0,a.jsxs)("select",{name:"category",value:d.category,onChange:A,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select category..."}),j.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Tags"}),(0,a.jsx)("select",{name:"tags",value:d.tags,onChange:e=>{let t=Array.from(e.target.selectedOptions).map(e=>e.value);u(e=>({...e,tags:t}))},className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400",multiple:!0,children:N.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Hold Ctrl (Windows) or Cmd (Mac) to select multiple tags."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Status"}),(0,a.jsxs)("select",{name:"status",value:d.status,onChange:A,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400",children:[(0,a.jsx)("option",{value:"draft",children:"Draft"}),(0,a.jsx)("option",{value:"published",children:"Published"})]})]}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)("input",{type:"checkbox",name:"featured",id:"featured",checked:d.featured,onChange:A,className:"mr-2"}),(0,a.jsx)("label",{htmlFor:"featured",className:"text-sm font-medium text-gray-900",children:"Featured"})]}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)("input",{type:"checkbox",name:"allow_comments",id:"allow_comments",checked:d.allow_comments,onChange:A,className:"mr-2"}),(0,a.jsx)("label",{htmlFor:"allow_comments",className:"text-sm font-medium text-gray-900",children:"Allow Comments"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Views"}),(0,a.jsx)("input",{name:"views",type:"number",value:d.views,onChange:A,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Reading Time (min)"}),(0,a.jsx)("input",{name:"reading_time",type:"number",value:d.reading_time,onChange:A,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Published At"}),(0,a.jsx)("input",{name:"published_at",type:"datetime-local",value:d.published_at?d.published_at.slice(0,16):"",onChange:A,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Meta Title"}),(0,a.jsx)("input",{name:"meta_title",value:d.meta_title,onChange:A,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Meta Description"}),(0,a.jsx)("input",{name:"meta_description",value:d.meta_description,onChange:A,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Meta Keywords"}),(0,a.jsx)("input",{name:"meta_keywords",value:d.meta_keywords,onChange:A,className:"w-full border border-gray-400 rounded px-2 py-1 text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-400"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end pt-4",children:[(0,a.jsx)("button",{type:"button",className:"mr-4 px-4 py-2 rounded border border-gray-400 bg-gray-200 text-gray-900 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400",onClick:D,disabled:h,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-6 py-2 rounded bg-blue-800 text-white hover:bg-blue-900 disabled:opacity-60 focus:outline-none focus:ring-2 focus:ring-blue-400",disabled:h,children:h?"Saving...":m?"Update":"Create"})]})]})]})})]})}},3898:(e,t,s)=>{Promise.resolve().then(s.bind(s,1325))}},e=>{var t=t=>e(e.s=t);e.O(0,[956,788,97,358],()=>t(3898)),_N_E=e.O()}]);